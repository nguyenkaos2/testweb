

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>8. Decorators &mdash; Python Tips 0.1 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="Python Tips 0.1 documentation" href="index.html"/>
        <link rel="next" title="9. Global &amp; Return" href="global_&amp;_return.html"/>
        <link rel="prev" title="7. Ternary Operators" href="ternary_operators.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> Python Tips
          

          
          </a>

          
            
            
              <div class="version">
                0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="CaoNotes.html">1. *args and **kwargs</a></li>
<li class="toctree-l1"><a class="reference internal" href="args_and_kwargs.html">2. *args and **kwargs</a></li>
<li class="toctree-l1"><a class="reference internal" href="debugging.html">3. Debugging</a></li>
<li class="toctree-l1"><a class="reference internal" href="generators.html">4. Generators</a></li>
<li class="toctree-l1"><a class="reference internal" href="map_filter.html">5. Map, Filter and Reduce</a></li>
<li class="toctree-l1"><a class="reference internal" href="set_-_data_structure.html">6. <code class="docutils literal"><span class="pre">set</span></code> Data Structure</a></li>
<li class="toctree-l1"><a class="reference internal" href="ternary_operators.html">7. Ternary Operators</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">8. Decorators</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#everything-in-python-is-an-object">8.1. Everything in Python is an object:</a></li>
<li class="toctree-l2"><a class="reference internal" href="#defining-functions-within-functions">8.2. Defining functions within functions:</a></li>
<li class="toctree-l2"><a class="reference internal" href="#returning-functions-from-within-functions">8.3. Returning functions from within functions:</a></li>
<li class="toctree-l2"><a class="reference internal" href="#giving-a-function-as-an-argument-to-another-function">8.4. Giving a function as an argument to another function:</a></li>
<li class="toctree-l2"><a class="reference internal" href="#writing-your-first-decorator">8.5. Writing your first decorator:</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#use-cases">8.5.1. Use-cases:</a></li>
<li class="toctree-l3"><a class="reference internal" href="#authorization">8.5.2. Authorization</a></li>
<li class="toctree-l3"><a class="reference internal" href="#logging">8.5.3. Logging</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#decorators-with-arguments">8.6. Decorators with Arguments</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#nesting-a-decorator-within-a-function">8.6.1. Nesting a Decorator Within a Function</a></li>
<li class="toctree-l3"><a class="reference internal" href="#decorator-classes">8.6.2. Decorator Classes</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="global_&amp;_return.html">9. Global &amp; Return</a></li>
<li class="toctree-l1"><a class="reference internal" href="mutation.html">10. Mutation</a></li>
<li class="toctree-l1"><a class="reference internal" href="__slots__magic.html">11. __slots__ Magic</a></li>
<li class="toctree-l1"><a class="reference internal" href="virtual_environment.html">12. Virtual Environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="collections.html">13. Collections</a></li>
<li class="toctree-l1"><a class="reference internal" href="enumerate.html">14. Enumerate</a></li>
<li class="toctree-l1"><a class="reference internal" href="object_introspection.html">15. Object introspection</a></li>
<li class="toctree-l1"><a class="reference internal" href="comprehensions.html">16. Comprehensions</a></li>
<li class="toctree-l1"><a class="reference internal" href="exceptions.html">17. Exceptions</a></li>
<li class="toctree-l1"><a class="reference internal" href="lambdas.html">18. Lambdas</a></li>
<li class="toctree-l1"><a class="reference internal" href="one_liners.html">19. One-Liners</a></li>
<li class="toctree-l1"><a class="reference internal" href="for_-_else.html">20. For - Else</a></li>
<li class="toctree-l1"><a class="reference internal" href="python_c_extension.html">21. Python C extensions</a></li>
<li class="toctree-l1"><a class="reference internal" href="open_function.html">22. <code class="docutils literal"><span class="pre">open</span></code> Function</a></li>
<li class="toctree-l1"><a class="reference internal" href="targeting_python_2_3.html">23. Targeting Python 2+3</a></li>
<li class="toctree-l1"><a class="reference internal" href="coroutines.html">24. Coroutines</a></li>
<li class="toctree-l1"><a class="reference internal" href="function_caching.html">25. Function caching</a></li>
<li class="toctree-l1"><a class="reference internal" href="context_managers.html">26. Context managers</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Python Tips</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>8. Decorators</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/decorators.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="decorators">
<h1>8. Decorators<a class="headerlink" href="#decorators" title="Permalink to this headline">¶</a></h1>
<p>Decorators are a significant part of Python. In simple words: they are
functions which modify the functionality of another function. They help
to make our code shorter and more Pythonic. Most of the beginners do not
know where to use them so I am going to share some areas where
decorators can make your code more concise.</p>
<p>First, let’s discuss how to write your own decorator.</p>
<p>It is perhaps one of the most difficult concepts to grasp. We will take
it one step at a time so that you can fully understand it.</p>
<div class="section" id="everything-in-python-is-an-object">
<h2>8.1. Everything in Python is an object:<a class="headerlink" href="#everything-in-python-is-an-object" title="Permalink to this headline">¶</a></h2>
<p>First of all let’s understand functions in Python:</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">hi</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;yasoob&quot;</span><span class="p">):</span>
    <span class="k">return</span> <span class="s2">&quot;hi &quot;</span> <span class="o">+</span> <span class="n">name</span>

<span class="nb">print</span><span class="p">(</span><span class="n">hi</span><span class="p">())</span>
<span class="c1"># output: &#39;hi yasoob&#39;</span>

<span class="c1"># We can even assign a function to a variable like</span>
<span class="n">greet</span> <span class="o">=</span> <span class="n">hi</span>
<span class="c1"># We are not using parentheses here because we are not calling the function hi</span>
<span class="c1"># instead we are just putting it into the greet variable. Let&#39;s try to run this</span>

<span class="nb">print</span><span class="p">(</span><span class="n">greet</span><span class="p">())</span>
<span class="c1"># output: &#39;hi yasoob&#39;</span>

<span class="c1"># Let&#39;s see what happens if we delete the old hi function!</span>
<span class="k">del</span> <span class="n">hi</span>
<span class="nb">print</span><span class="p">(</span><span class="n">hi</span><span class="p">())</span>
<span class="c1">#outputs: NameError</span>

<span class="nb">print</span><span class="p">(</span><span class="n">greet</span><span class="p">())</span>
<span class="c1">#outputs: &#39;hi yasoob&#39;</span>
</pre></div>
</div>
</div>
<div class="section" id="defining-functions-within-functions">
<h2>8.2. Defining functions within functions:<a class="headerlink" href="#defining-functions-within-functions" title="Permalink to this headline">¶</a></h2>
<p>So those are the basics when it comes to functions. Let’s take your
knowledge one step further. In Python we can define functions inside
other functions:</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">hi</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;yasoob&quot;</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;now you are inside the hi() function&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">greet</span><span class="p">():</span>
        <span class="k">return</span> <span class="s2">&quot;now you are in the greet() function&quot;</span>

    <span class="k">def</span> <span class="nf">welcome</span><span class="p">():</span>
        <span class="k">return</span> <span class="s2">&quot;now you are in the welcome() function&quot;</span>

    <span class="nb">print</span><span class="p">(</span><span class="n">greet</span><span class="p">())</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">welcome</span><span class="p">())</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;now you are back in the hi() function&quot;</span><span class="p">)</span>

<span class="n">hi</span><span class="p">()</span>
<span class="c1">#output:now you are inside the hi() function</span>
<span class="c1">#       now you are in the greet() function</span>
<span class="c1">#       now you are in the welcome() function</span>
<span class="c1">#       now you are back in the hi() function</span>

<span class="c1"># This shows that whenever you call hi(), greet() and welcome()</span>
<span class="c1"># are also called. However the greet() and welcome() functions</span>
<span class="c1"># are not available outside the hi() function e.g:</span>

<span class="n">greet</span><span class="p">()</span>
<span class="c1">#outputs: NameError: name &#39;greet&#39; is not defined</span>
</pre></div>
</div>
<p>So now we know that we can define functions in other functions. In
other words: we can make nested functions. Now you need to learn one
more thing, that functions can return functions too.</p>
</div>
<div class="section" id="returning-functions-from-within-functions">
<h2>8.3. Returning functions from within functions:<a class="headerlink" href="#returning-functions-from-within-functions" title="Permalink to this headline">¶</a></h2>
<p>It is not necessary to execute a function within another function, we
can return it as an output as well:</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">hi</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;yasoob&quot;</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">greet</span><span class="p">():</span>
        <span class="k">return</span> <span class="s2">&quot;now you are in the greet() function&quot;</span>

    <span class="k">def</span> <span class="nf">welcome</span><span class="p">():</span>
        <span class="k">return</span> <span class="s2">&quot;now you are in the welcome() function&quot;</span>

    <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;yasoob&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">greet</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">welcome</span>

<span class="n">a</span> <span class="o">=</span> <span class="n">hi</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="c1">#outputs: &lt;function greet at 0x7f2143c01500&gt;</span>

<span class="c1">#This clearly shows that `a` now points to the greet() function in hi()</span>
<span class="c1">#Now try this</span>

<span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">())</span>
<span class="c1">#outputs: now you are in the greet() function</span>
</pre></div>
</div>
<p>Just take a look at the code again. In the <code class="docutils literal"><span class="pre">if/else</span></code> clause we are
returning <code class="docutils literal"><span class="pre">greet</span></code> and <code class="docutils literal"><span class="pre">welcome</span></code>, not <code class="docutils literal"><span class="pre">greet()</span></code> and <code class="docutils literal"><span class="pre">welcome()</span></code>.
Why is that? It’s because when you put a pair of parentheses after it, the
function gets executed; whereas if you don’t put parenthesis after it,
then it can be passed around and can be assigned to other variables
without executing it. Did you get it? Let me explain it in a little bit
more detail. When we write <code class="docutils literal"><span class="pre">a</span> <span class="pre">=</span> <span class="pre">hi()</span></code>, <code class="docutils literal"><span class="pre">hi()</span></code> gets executed and
because the name is yasoob by default, the function <code class="docutils literal"><span class="pre">greet</span></code> is returned.
If we change the statement to <code class="docutils literal"><span class="pre">a</span> <span class="pre">=</span> <span class="pre">hi(name</span> <span class="pre">=</span> <span class="pre">&quot;ali&quot;)</span></code> then the <code class="docutils literal"><span class="pre">welcome</span></code>
function will be returned. We can also do print <code class="docutils literal"><span class="pre">hi()()</span></code> which outputs
<em>now you are in the greet() function</em>.</p>
</div>
<div class="section" id="giving-a-function-as-an-argument-to-another-function">
<h2>8.4. Giving a function as an argument to another function:<a class="headerlink" href="#giving-a-function-as-an-argument-to-another-function" title="Permalink to this headline">¶</a></h2>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">hi</span><span class="p">():</span>
    <span class="k">return</span> <span class="s2">&quot;hi yasoob!&quot;</span>

<span class="k">def</span> <span class="nf">doSomethingBeforeHi</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;I am doing some boring work before executing hi()&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">func</span><span class="p">())</span>

<span class="n">doSomethingBeforeHi</span><span class="p">(</span><span class="n">hi</span><span class="p">)</span>
<span class="c1">#outputs:I am doing some boring work before executing hi()</span>
<span class="c1">#        hi yasoob!</span>
</pre></div>
</div>
<p>Now you have all the required knowledge to learn what decorators really
are. Decorators let you execute code before and after a function.</p>
</div>
<div class="section" id="writing-your-first-decorator">
<h2>8.5. Writing your first decorator:<a class="headerlink" href="#writing-your-first-decorator" title="Permalink to this headline">¶</a></h2>
<p>In the last example we actually made a decorator! Let’s modify the
previous decorator and make a little bit more usable program:</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">a_new_decorator</span><span class="p">(</span><span class="n">a_func</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">wrapTheFunction</span><span class="p">():</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;I am doing some boring work before executing a_func()&quot;</span><span class="p">)</span>

        <span class="n">a_func</span><span class="p">()</span>

        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;I am doing some boring work after executing a_func()&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">wrapTheFunction</span>

<span class="k">def</span> <span class="nf">a_function_requiring_decoration</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;I am the function which needs some decoration to remove my foul smell&quot;</span><span class="p">)</span>

<span class="n">a_function_requiring_decoration</span><span class="p">()</span>
<span class="c1">#outputs: &quot;I am the function which needs some decoration to remove my foul smell&quot;</span>

<span class="n">a_function_requiring_decoration</span> <span class="o">=</span> <span class="n">a_new_decorator</span><span class="p">(</span><span class="n">a_function_requiring_decoration</span><span class="p">)</span>
<span class="c1">#now a_function_requiring_decoration is wrapped by wrapTheFunction()</span>

<span class="n">a_function_requiring_decoration</span><span class="p">()</span>
<span class="c1">#outputs:I am doing some boring work before executing a_func()</span>
<span class="c1">#        I am the function which needs some decoration to remove my foul smell</span>
<span class="c1">#        I am doing some boring work after executing a_func()</span>
</pre></div>
</div>
<p>Did you get it? We just applied the previously learned principles. This
is exactly what the decorators do in Python! They wrap a function and
modify its behaviour in one way or the another. Now you might be
wondering that we did not use the &#64; anywhere in our code? That is just a
short way of making up a decorated function. Here is how we could have
run the previous code sample using &#64;.</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="nd">@a_new_decorator</span>
<span class="k">def</span> <span class="nf">a_function_requiring_decoration</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Hey you! Decorate me!&quot;&quot;&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;I am the function which needs some decoration to &quot;</span>
          <span class="s2">&quot;remove my foul smell&quot;</span><span class="p">)</span>

<span class="n">a_function_requiring_decoration</span><span class="p">()</span>
<span class="c1">#outputs: I am doing some boring work before executing a_func()</span>
<span class="c1">#         I am the function which needs some decoration to remove my foul smell</span>
<span class="c1">#         I am doing some boring work after executing a_func()</span>

<span class="c1">#the @a_new_decorator is just a short way of saying:</span>
<span class="n">a_function_requiring_decoration</span> <span class="o">=</span> <span class="n">a_new_decorator</span><span class="p">(</span><span class="n">a_function_requiring_decoration</span><span class="p">)</span>
</pre></div>
</div>
<p>I hope you now have a basic understanding of how decorators work in
Python. Now there is one problem with our code. If we run:</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">a_function_requiring_decoration</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
<span class="c1"># Output: wrapTheFunction</span>
</pre></div>
</div>
<p>That’s not what we expected! Its name is
“a_function_requiring_decoration”. Well our function was replaced by
wrapTheFunction. It overrode the name and docstring of our function.
Luckily Python provides us a simple function to solve this problem and
that is <code class="docutils literal"><span class="pre">functools.wraps</span></code>. Let’s modify our previous example to use
<code class="docutils literal"><span class="pre">functools.wraps</span></code>:</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">functools</span> <span class="k">import</span> <span class="n">wraps</span>

<span class="k">def</span> <span class="nf">a_new_decorator</span><span class="p">(</span><span class="n">a_func</span><span class="p">):</span>
    <span class="nd">@wraps</span><span class="p">(</span><span class="n">a_func</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">wrapTheFunction</span><span class="p">():</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;I am doing some boring work before executing a_func()&quot;</span><span class="p">)</span>
        <span class="n">a_func</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;I am doing some boring work after executing a_func()&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">wrapTheFunction</span>

<span class="nd">@a_new_decorator</span>
<span class="k">def</span> <span class="nf">a_function_requiring_decoration</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Hey yo! Decorate me!&quot;&quot;&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;I am the function which needs some decoration to &quot;</span>
          <span class="s2">&quot;remove my foul smell&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">a_function_requiring_decoration</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
<span class="c1"># Output: a_function_requiring_decoration</span>
</pre></div>
</div>
<p>Now that is much better. Let’s move on and learn some use-cases of
decorators.</p>
<p><strong>Blueprint:</strong></p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">functools</span> <span class="k">import</span> <span class="n">wraps</span>
<span class="k">def</span> <span class="nf">decorator_name</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
    <span class="nd">@wraps</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">decorated</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">can_run</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;Function will not run&quot;</span>
        <span class="k">return</span> <span class="n">f</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">decorated</span>

<span class="nd">@decorator_name</span>
<span class="k">def</span> <span class="nf">func</span><span class="p">():</span>
    <span class="k">return</span><span class="p">(</span><span class="s2">&quot;Function is running&quot;</span><span class="p">)</span>

<span class="n">can_run</span> <span class="o">=</span> <span class="kc">True</span>
<span class="nb">print</span><span class="p">(</span><span class="n">func</span><span class="p">())</span>
<span class="c1"># Output: Function is running</span>

<span class="n">can_run</span> <span class="o">=</span> <span class="kc">False</span>
<span class="nb">print</span><span class="p">(</span><span class="n">func</span><span class="p">())</span>
<span class="c1"># Output: Function will not run</span>
</pre></div>
</div>
<p>Note: <code class="docutils literal"><span class="pre">&#64;wraps</span></code> takes a function to be decorated and adds the
functionality of copying over the function name, docstring, arguments
list, etc. This allows to access the pre-decorated function’s properties
in the decorator.</p>
<div class="section" id="use-cases">
<h3>8.5.1. Use-cases:<a class="headerlink" href="#use-cases" title="Permalink to this headline">¶</a></h3>
<p>Now let’s take a look at the areas where decorators really shine and
their usage makes something really easy to manage.</p>
</div>
<div class="section" id="authorization">
<h3>8.5.2. Authorization<a class="headerlink" href="#authorization" title="Permalink to this headline">¶</a></h3>
<p>Decorators can help to check whether someone is authorized to use an
endpoint in a web application. They are extensively used in Flask web
framework and Django. Here is an example to employ decorator based
authentication:</p>
<p><strong>Example :</strong></p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">functools</span> <span class="k">import</span> <span class="n">wraps</span>

<span class="k">def</span> <span class="nf">requires_auth</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
    <span class="nd">@wraps</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">decorated</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">auth</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">authorization</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">auth</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">check_auth</span><span class="p">(</span><span class="n">auth</span><span class="o">.</span><span class="n">username</span><span class="p">,</span> <span class="n">auth</span><span class="o">.</span><span class="n">password</span><span class="p">):</span>
            <span class="n">authenticate</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">f</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">decorated</span>
</pre></div>
</div>
</div>
<div class="section" id="logging">
<h3>8.5.3. Logging<a class="headerlink" href="#logging" title="Permalink to this headline">¶</a></h3>
<p>Logging is another area where the decorators shine. Here is an example:</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">functools</span> <span class="k">import</span> <span class="n">wraps</span>

<span class="k">def</span> <span class="nf">logit</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
    <span class="nd">@wraps</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">with_logging</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">func</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">+</span> <span class="s2">&quot; was called&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">with_logging</span>

<span class="nd">@logit</span>
<span class="k">def</span> <span class="nf">addition_func</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
   <span class="sd">&quot;&quot;&quot;Do some math.&quot;&quot;&quot;</span>
   <span class="k">return</span> <span class="n">x</span> <span class="o">+</span> <span class="n">x</span>


<span class="n">result</span> <span class="o">=</span> <span class="n">addition_func</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="c1"># Output: addition_func was called</span>
</pre></div>
</div>
<p>I am sure you are already thinking about some clever uses of decorators.</p>
</div>
</div>
<div class="section" id="decorators-with-arguments">
<h2>8.6. Decorators with Arguments<a class="headerlink" href="#decorators-with-arguments" title="Permalink to this headline">¶</a></h2>
<p>Come to think of it, isn’t <code class="docutils literal"><span class="pre">&#64;wraps</span></code> also a decorator?  But, it takes an
argument like any normal function can do.  So, why can’t we do that too?</p>
<p>This is because when you use the <code class="docutils literal"><span class="pre">&#64;my_decorator</span></code> syntax, you are
applying a wrapper function with a single function as a parameter
Remember, everything in Python is an object, and this includes
functions!  With that in mind, we can write a function that returns
a wrapper function.</p>
<div class="section" id="nesting-a-decorator-within-a-function">
<h3>8.6.1. Nesting a Decorator Within a Function<a class="headerlink" href="#nesting-a-decorator-within-a-function" title="Permalink to this headline">¶</a></h3>
<p>Let’s go back to our logging example, and create a wrapper which lets
us specify a logfile to output to.</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">functools</span> <span class="k">import</span> <span class="n">wraps</span>

<span class="k">def</span> <span class="nf">logit</span><span class="p">(</span><span class="n">logfile</span><span class="o">=</span><span class="s1">&#39;out.log&#39;</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">logging_decorator</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
        <span class="nd">@wraps</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
        <span class="k">def</span> <span class="nf">wrapped_function</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
            <span class="n">log_string</span> <span class="o">=</span> <span class="n">func</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">+</span> <span class="s2">&quot; was called&quot;</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">log_string</span><span class="p">)</span>
            <span class="c1"># Open the logfile and append</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">logfile</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">opened_file</span><span class="p">:</span>
                <span class="c1"># Now we log to the specified logfile</span>
                <span class="n">opened_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">log_string</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">wrapped_function</span>
    <span class="k">return</span> <span class="n">logging_decorator</span>

<span class="nd">@logit</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">myfunc1</span><span class="p">():</span>
    <span class="k">pass</span>

<span class="n">myfunc1</span><span class="p">()</span>
<span class="c1"># Output: myfunc1 was called</span>
<span class="c1"># A file called out.log now exists, with the above string</span>

<span class="nd">@logit</span><span class="p">(</span><span class="n">logfile</span><span class="o">=</span><span class="s1">&#39;func2.log&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">myfunc2</span><span class="p">():</span>
    <span class="k">pass</span>

<span class="n">myfunc2</span><span class="p">()</span>
<span class="c1"># Output: myfunc2 was called</span>
<span class="c1"># A file called func2.log now exists, with the above string</span>
</pre></div>
</div>
</div>
<div class="section" id="decorator-classes">
<h3>8.6.2. Decorator Classes<a class="headerlink" href="#decorator-classes" title="Permalink to this headline">¶</a></h3>
<p>Now we have our logit decorator in production, but when some parts
of our application are considered critical, failure might be
something that needs more immediate attention.  Let’s say sometimes
you want to just log to a file.  Other times you want an email sent,
so the problem is brought to your attention, and still keep a log
for your own records.  This is a case for using inheritence, but
so far we’ve only seen functions being used to build decorators.</p>
<p>Luckily, classes can also be used to build decorators.  So, let’s
rebuild logit as a class instead of a function.</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">logit</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">logfile</span><span class="o">=</span><span class="s1">&#39;out.log&#39;</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logfile</span> <span class="o">=</span> <span class="n">logfile</span>

    <span class="k">def</span> <span class="nf">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">):</span>
        <span class="n">log_string</span> <span class="o">=</span> <span class="n">func</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">+</span> <span class="s2">&quot; was called&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">log_string</span><span class="p">)</span>
        <span class="c1"># Open the logfile and append</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">logfile</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">opened_file</span><span class="p">:</span>
            <span class="c1"># Now we log to the specified logfile</span>
            <span class="n">opened_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">log_string</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="c1"># Now, send a notification</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">notify</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">notify</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># logit only logs, no more</span>
        <span class="k">pass</span>
</pre></div>
</div>
<p>This implementation has an additional advantage of being much cleaner than
the nested function approach, and wrapping a function still will use
the same syntax as before:</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="nd">@logit</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">myfunc1</span><span class="p">():</span>
    <span class="k">pass</span>
</pre></div>
</div>
<p>Now, let’s subclass logit to add email functionality (though this topic
will not be covered here).</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">email_logit</span><span class="p">(</span><span class="n">logit</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    A logit implementation for sending emails to admins</span>
<span class="sd">    when the function is called.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">email</span><span class="o">=</span><span class="s1">&#39;admin@myproject.com&#39;</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">email</span> <span class="o">=</span> <span class="n">email</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">email_logit</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">notify</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Send an email to self.email</span>
        <span class="c1"># Will not be implemented here</span>
        <span class="k">pass</span>
</pre></div>
</div>
<p>From here, <code class="docutils literal"><span class="pre">&#64;email_logit</span></code> works just like <code class="docutils literal"><span class="pre">&#64;logit</span></code> but sends an email
to the admin in addition to logging.</p>
</div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="global_&amp;_return.html" class="btn btn-neutral float-right" title="9. Global &amp; Return" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="ternary_operators.html" class="btn btn-neutral" title="7. Ternary Operators" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Muhammad Yasoob Ullah Khalid.

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>